name: Gitops rules for updating springboot-demo1

sources:
  latest-version-springboot-demo1:
    name: "Get latest helm chart version"
    kind: "helmchart"
    spec:
      url: "oci://ghcr.io/myspotontheweb/spring-boot-demo1/charts/demo1"
      username: '{{ requiredEnv "GH_USERNAME" }}'
      password: '{{ requiredEnv "GH_PASSWORD" }}'
      versionfilter:
        kind: latest

targets:
  update-dev-springboot-demo1:
    name: "Update the helm chart used to deploy Dev environment"
    kind: "helmchart"
    spec:
      name: "apps/springboot-demo1/dev"
      appversion: false
      file: "Chart.yaml"
      key: "dependencies[0].version"