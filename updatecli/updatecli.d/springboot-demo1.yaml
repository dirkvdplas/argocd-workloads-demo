name: Update springboot-demo1 Helm chart

sources:
  springboot-demo1:
    name: "Get springboot-demo1 latest version"
    kind: "helmchart"
    spec:
      url: "oci://ghcr.io/myspotontheweb/spring-boot-demo1/charts/demo1"
      username: '{{ requiredEnv "GH_USERNAME" }}'
      password: '{{ requiredEnv "GH_PASSWORD" }}'
      versionfilter:
        kind: latest

targets:
  springboot-demo1:
    name: "Get springboot-demo1 latest version"
    kind: "helmchart"
    scmid: default
    spec:
      name: "apps/springboot-demo1/dev"
      appversion: false
      file: "Chart.yaml"
      key: "dependencies[0].version"

actions:
  springboot-demo1:
    kind: "github/pullrequest"
    scmid: default
    spec:
      description: "Update springboot-demo1 latest version"
      title: "springboot-demo1 update"
      automerge: false
      usetitleforautomerge: false
      mergemethod: squash
      draft: false

scms:
  default:
    kind: github
    spec:
      user: "git user to push from changes"
      email: "mark@myspotontheweb.com"
      owner: "myspotontheweb"
      repository: "argocd-workloads-demo"
      username: '{{ requiredEnv "GH_USERNAME" }}'
      token: '{{ requiredEnv "GH_PASSWORD" }}'
      branch: "main"
      commitmessage:
        type: "feat"
        title: "Override default commit title"
